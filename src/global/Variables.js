// import ml5 from "ml5";

export const chords = [
    "C",
    "Db",
    "D",
    "Eb",
    "E",
    "F",
    "Gb",
    "G",
    "Ab",
    "A",
    "Bb",
    "B"
];
export const chordsTenan = [
    "C",
    "Db",
    "D",
    "Eb",
    "E",
    "F",
    "Gb",
    "G",
    "Ab",
    "A",
    "Bb",
    "B",
    "Cm",
    "Dbm",
    "Dm",
    "Ebm",
    "Em",
    "Fm",
    "Gbm",
    "Gm",
    "Abm",
    "Am",
    "Bbm",
    "Bm"
];
const chordsblmacak = [
    "C",
    "Db",
    "D",
    "Eb",
    "E",
    "F",
    "Gb",
    "G",
    "Ab",
    "A",
    "Bb",
    "B",
    "C",
    "Db",
    "D",
    "Eb",
    "E",
    "F",
    "Gb",
    "G",
    "Ab",
    "A",
    "Bb",
    "B"
];
// export const indexToNote = [
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "E",
//     "G",
//     "A",
//     "B", //10
//     "C",
//     "Db",
//     "D",
//     "E",
//     "F",
//     "Gb",
//     "G",
//     "Ab",
//     "A",
//     "Bb", //20
//     "B",
//     "C",
//     "Db",
//     "Db",
//     "D",
//     "Eb",
//     "Eb",
//     "E",
//     "E",
//     "F", //30
//     "Gb",
//     "Gb",
//     "G",
//     "G",
//     "Ab",
//     "Ab",
//     "A",
//     "A",
//     "Bb",
//     "Bb", //40
//     "B",
//     "B",
//     "B",
//     "C",
//     "C",
//     "Db",
//     "Db",
//     "Db",
//     "D",
//     "D", //50
//     "D",
//     "Eb",
//     "Eb",
//     "Eb",
//     "E",
//     "E",
//     "E",
//     "F",
//     "F",
//     "F", //60
//     "...",
//     "Gb",
//     "Gb",
//     "Gb",
//     "...",
//     "G",
//     "G",
//     "G",
//     "...",
//     "Ab", //70
//     "Ab",
//     "Ab",
//     "...",
//     "...",
//     "A",
//     "A",
//     "A",
//     "...",
//     "Bb",
//     "Bb", //80
//     "Bb",
//     "...",
//     "B",
//     "B",
//     "B",
//     "...",
//     "...",
//     "C",
//     "C",
//     "C", //90
//     "...",
//     "...",
//     "...",
//     "Db",
//     "Db",
//     "Db",
//     "...",
//     "...",
//     "D",
//     "D", //100
//     "D",
//     "...",
//     "...",
//     "...",
//     "Eb",
//     "Eb",
//     "Eb",
//     "...",
//     "...",
//     "...", //110
//     "E",
//     "E",
//     "E",
//     "E",
//     "...",
//     "...",
//     "...",
//     "F",
//     "F",
//     "F", //120
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "Gb",
//     "Gb",
//     "Gb",
//     "...",
//     "...", //130
//     "...",
//     "...",
//     "...",
//     "G",
//     "G",
//     "G",
//     "...",
//     "...",
//     "...",
//     "...", //140
//     "...",
//     "Ab",
//     "Ab",
//     "Ab",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "A", //150
//     "A",
//     "A",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "Bb",
//     "Bb", //160
//     "Bb",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "B",
//     "B",
//     "B", //170
//     "B",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "...",
//     "C",
//     "C"
// ];
export var pitches = {
    B0: 30.86771,
    C1: 32.7032,
    Db1: 34.64783,
    D1: 36.7081,
    Eb1: 38.89087,
    E1: 41.20344,
    F1: 43.65353,
    Gb1: 46.2493,
    G1: 48.99943,
    Ab1: 51.91309,
    A1: 55,
    Bb1: 58.27047,
    B1: 61.73541,
    C2: 65.40639,
    Db2: 69.29566,
    D2: 73.41619,
    Eb2: 77.78175,
    E2: 82.40689,
    F2: 87.30706,
    Gb2: 92.49861,
    G2: 97.99886,
    Ab2: 103.8262,
    A2: 110,
    Bb2: 116.5409,
    B2: 123.4708,
    C3: 130.8128,
    Db3: 138.5913,
    D3: 146.8324,
    Eb3: 155.5635,
    E3: 164.8138,
    F3: 174.6141,
    Gb3: 184.9972,
    G3: 195.9977,
    Ab3: 207.6523,
    A3: 220,
    Bb3: 233.0819,
    B3: 246.9417,
    C4: 261.6256,
    Db4: 277.1826,
    D4: 293.6648,
    Eb4: 311.127,
    E4: 329.6276,
    F4: 349.2282,
    Gb4: 369.9944,
    G4: 391.9954,
    Ab4: 415.3047,
    A4: 440,
    Bb4: 466.1638,
    B4: 493.8833,
    C5: 523.2511,
    Db5: 554.3653,
    D5: 587.3295,
    Eb5: 622.254,
    E5: 659.2551,
    F5: 698.4565,
    Gb5: 739.9888,
    G5: 783.9909,
    Ab5: 830.6094,
    A5: 880,
    Bb5: 932.3275,
    B5: 987.7666,
    C6: 1046.502,
    Db6: 1108.731,
    D6: 1174.659,
    Eb6: 1244.508,
    E6: 1318.51,
    F6: 1396.913,
    Gb6: 1479.978,
    G6: 1567.982,
    Ab6: 1661.219,
    A6: 1760,
    Bb6: 1864.655,
    B6: 1975.533,
    C7: 2093.005,
    Db7: 2217.461,
    D7: 2349.318,
    Eb7: 2489.016,
    E7: 2637.02,
    F7: 2793.826,
    Gb7: 2959.955,
    G7: 3135.963,
    Ab7: 3322.438,
    A7: 3520,
    Bb7: 3729.31,
    B7: 3951.066,
    C8: 4186.009,
    Db8: 4434.922,
    D8: 4698.636,
    Eb8: 4978.032
};
export function acakArray(array) {
    let currentIndex = array.length,
        randomIndex;
    while (currentIndex != 0) {
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex--;
        [array[currentIndex], array[randomIndex]] = [
            array[randomIndex],
            array[currentIndex]
        ];
    }
    return array;
}
export const chordsacak = acakArray(chordsblmacak);
export const majorscale = [
    ["C", "D", "E", "F", "G", "A", "B"],
    ["Db", "Eb", "F", "Gb", "Ab", "Bb", "C"],
    ["D", "E", "Gb", "G", "A", "B", "Db"],
    ["Eb", "F", "G", "Ab", "Bb", "C", "D"],
    ["E", "Gb", "Ab", "A", "B", "Db", "Eb"],
    ["F", "G", "A", "Bb", "C", "D", "E"],
    ["Gb", "Ab", "Bb", "B", "Db", "Eb", "F"],
    ["G", "A", "B", "C", "D", "E", "Gb"],
    ["Ab", "Bb", "C", "Db", "Eb", "F", "G"],
    ["A", "B", "Db", "D", "E", "Gb", "Ab"],
    ["Bb", "C", "D", "Eb", "F", "G", "A"],
    ["B", "Db", "Eb", "E", "Gb", "Ab", "Bb"]
];
export const chordmajorscale = [
    ["C", "Dm", "Em", "F", "G", "Am", "Bdim"],
    ["Db", "Ebm", "Fm", "Gb", "Ab", "Bbm", "Cdim"],
    ["D", "Em", "Gbm", "G", "A", "Bm", "Dbdim"],
    ["Eb", "Fm", "Gm", "Ab", "Bb", "Cm", "Ddim"],
    ["E", "Gbm", "Abm", "A", "B", "Dbm", "Ebdim"],
    ["F", "Gm", "Am", "Bb", "C", "Dm", "Edim"],
    ["Gb", "Abm", "Bbm", "B", "Db", "Ebm", "Fdim"],
    ["G", "Am", "Bm", "C", "D", "Em", "Gbdim"],
    ["Ab", "Bbm", "Cm", "Db", "Eb", "Fm", "Gdim"],
    ["A", "Bm", "Dbm", "D", "E", "Gbm", "Abdim"],
    ["Bb", "Cm", "Dm", "Eb", "F", "Gm", "Adim"],
    ["B", "Dbm", "Ebm", "E", "Gb", "Abm", "Bbdim"]
];
export const solmisasi = ["Do", "Re", "Mi", "Fa", "Sol", "La", "Si"];
//cariMajorscale("D", 2)
export function cariMajorscale(note, posisi) {
    return majorscale.find((data) => data[posisi - 1] == note);
}
//carChordMajorScale("Dm", 3)
export function cariChordMajorscale(chord, posisi) {
    return chordmajorscale.find((data) => data[posisi - 1] == chord);
}
let audios1 = [];
let audiosCount = 0;
for (let j = 4; j < 7; j++) {
    for (let i = 0; i < 12; i++) {
        audios1[audiosCount] = new Audio(
            `https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/${chords[i]}${j}.mp3`
        );
        audiosCount++;
    }
}
audios1[audiosCount] = new Audio(
    `https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/C7.mp3`
);
export const audios = audios1;

/*
chord1C.mp3 - chord1B.mp3
chord1Cm.mp3 - chord1Bm.mp3
chord2C.mp3 - chord2B.mp3
chord2Cm.mp3 - chord2Bm.mp3
chord3C.mp3 - chord3B.mp3
chord3Cm.mp3 - chord3Bm.mp3
*/
let audioschord1 = [];
for (let j = 0; j < 3; j++) {
    for (let i = 0; i < 12; i++) {
        audioschord1[i + 24 * j] = new Audio(
            `https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/chord${
                j + 1
            }${chords[i]}.mp3`
        );
    }
    for (let i = 0; i < 12; i++) {
        audioschord1[i + 12 + 24 * j] = new Audio(
            `https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/chord${
                j + 1
            }${chords[i]}m.mp3`
        );
    }
}
export const audioschord = audioschord1;
export const audioBenar = new Audio(
    "https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/benar.mp3?v=1682574563954"
);
export const audioSalah = new Audio(
    "https://cdn.glitch.global/f9f20392-9f68-488a-b49d-d91c589220b8/salah.mp3"
);

export const convertLangkah = [
    {
        latihan: "Latihan 1 (Pitch)",
        sublatihan: [null],
        icon: "mic"
    },
    {
        latihan: "Latihan 2 (Solmisasi)",
        sublatihan: ["Naik", "Turun"],
        icon: "mic"
    },
    {
        latihan: "Materi 1 (Scale)",
        sublatihan: [null]
    },
    {
        latihan: "Latihan 3 (Ke 'Do')",
        sublatihan: [null],
        icon: "mic"
    },
    {
        latihan: "Latihan 4 (Interval Naik)",
        sublatihan: solmisasi,
        icon: "keyboard"
    },
    {
        latihan: "Latihan 5 (Interval Turun)",
        sublatihan: solmisasi,
        icon: "keyboard"
    },
    {
        latihan: "Latihan 6 (Interval)",
        sublatihan: solmisasi,
        icon: "mic"
    },
    {
        latihan: "Quiz 1 (Interval)",
        sublatihan: [null]
    },
    {
        latihan: "Materi 2 (Interval, Triad, Chord)",
        sublatihan: ["Interval", "Chord"]
    },
    {
        latihan: "Latihan 7 (Root, Inner, Outer)",
        sublatihan: ["Root", "Inner", "Outer"],
        icon: "mic"
    },
    {
        latihan: "Quiz 2 (Root, Inner, Outer)",
        sublatihan: [null]
    },
    {
        latihan: "Latihan 8 (Major dan Minor)",
        sublatihan: ["Lambat", "Sedang", "Cepat"],
        icon: "keyboard"
    },
    {
        latihan: "Quiz 3 (Major dan Minor)",
        sublatihan: [null]
    },
    {
        latihan: "Materi 3 (Chord Major Scale)",
        sublatihan: [null]
    },
    {
        latihan: "Latihan 9 (Chord Major Scale I IV V)",
        sublatihan: ["I", "IV", "V"],
        icon: "keyboard"
    },
    {
        latihan: "Latihan 10 (Chord Major Scale ii iii vi)",
        sublatihan: ["ii", "iii", "vi"],
        icon: "keyboard"
    },
    {
        latihan: "Latihan 11 (Chord Major Scale I ii iii IV V vi)",
        sublatihan: ["I", "ii", "iii", "IV", "V", "vi"],
        icon: "keyboard"
    },
    {
        latihan: "Quiz 4 (Chord Major Scale)",
        sublatihan: [null]
    },
    {
        latihan: "Materi 4 (Tahap Pengembangan)",
        sublatihan: [null]
    }
];
export function progresSiswa(lat, sub) {
    return [
        convertLangkah[lat - 1].latihan,
        convertLangkah[lat - 1].sublatihan[sub - 1]
    ];
}
export const arraySub = convertLangkah.map((data) => {
    return data.sublatihan.length;
});
export const progresBar = (lat, sub) => {
    //lat = index + 1
    let count = arraySub;
    let jmlSub = 0;
    for (let j = 0; j < arraySub.length; j++) {
        jmlSub += arraySub[j];
    }
    count[lat - 1] = sub;
    let sum = 0;
    for (let i = 0; i <= lat - 1; i++) {
        sum += count[i];
    }
    return parseFloat(((sum / jmlSub) * 100).toFixed(1));
};

export const cariTriad = (chord) => {
    let root;
    let inner;
    let outer;
    let jenis = "Major";
    if (chord.includes("b")) root = chord.slice(0, 2);
    else root = chord.charAt(0);
    if (chord.includes("m")) {
        inner = chords[(chords.indexOf(root) + 3) % 12];
        jenis = "Minor";
    } else inner = chords[(chords.indexOf(root) + 4) % 12];
    if (chord.includes("dim")) {
        outer = chords[(chords.indexOf(root) + 6) % 12];
        jenis = "Dim";
    } else outer = chords[(chords.indexOf(root) + 7) % 12];
    return [root, inner, outer, jenis];
};

export function freqKePitch(freq) {
    const nomorMIDI = Math.round(
        69 + (12 * Math.log(freq / 440)) / Math.log(2)
    );
    const notasi = [
        "C",
        "Db",
        "D",
        "Eb",
        "E",
        "F",
        "Gb",
        "G",
        "Ab",
        "A",
        "Bb",
        "B"
    ][nomorMIDI % 12];
    const oktaf = Math.floor(nomorMIDI / 12) - 1;
    return `${notasi}${oktaf}`;
}
export function dapatkanAmp(freq, spec) {
    const index = Math.round(freq * (spec.length / 24000));
    return spec[index];
}
export function mencariMIDITerdekat(terbaca, tujuan) {
    const a = (Number(terbaca.toFixed(2)) - tujuan) % 12;
    let hsl;
    if (a < 0) {
        if (a < -6) {
            hsl = a + 12;
        } else hsl = a;
    } else {
        if (a > 5) {
            hsl = a - 12;
        } else hsl = a;
    }
    const b = tujuan + hsl;
    return b;
}
export function freqKePersentaseSalah(soal, freqTerbaca) {
    const nmrMIDITujuan = chords.indexOf(soal) + 24;
    const nomorMIDI = 69 + (12 * Math.log(freqTerbaca / 440)) / Math.log(2);
    const nmrMIDITerdekat = mencariMIDITerdekat(nomorMIDI, nmrMIDITujuan);
    const persentaseSalah =
        Math.abs(Number(nmrMIDITerdekat.toFixed(2)) - nmrMIDITujuan) % 600;
    return Number(persentaseSalah.toFixed(2));
}

export function hitungRata(jumlah, banyak) {
    return Number((jumlah / banyak).toFixed(2));
}
